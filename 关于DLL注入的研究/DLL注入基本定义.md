# DLL注入基本定义

DLL注入（Dynamic Link Library Injection）是一种技术，允许恶意代码通过

将其自身或其他代码注入到另一个进程的地址空间中运行。DLL注入常被用于以下目的：

1. **绕过安全措施**：通过将恶意代码注入到合法进程中，可以绕过某些安全措施，如防病毒软件或防火墙。
2. **劫持功能**：注入的DLL可以拦截或劫持目标进程的功能调用，修改其行为。例如，键盘记录器可能通过注入DLL来拦截键盘输入。
3. **执行恶意代码**：注入的DLL可以执行任意恶意代码，从而对目标进程或系统造成损害。

### DLL注入的常见方法

1. **远程线程创建（CreateRemoteThread）**：使用Windows API函数 `CreateRemoteThread` 在目标进程中创建一个新线程，并将其入口点设置为LoadLibrary函数，从而加载恶意DLL。
2. **APC注入（Asynchronous Procedure Call Injection）**：将LoadLibrary函数排队到目标进程的APC队列中，当目标线程进入可警报状态时，APC会调用LoadLibrary加载恶意DLL。
3. **挂钩技术（Hooking）**：通过修改目标进程的内存中的函数指针或代码，劫持其执行流程，以加载或执行恶意代码。
4. **劫持IAT（Import Address Table Hijacking）**：修改目标进程的导入地址表，使其指向恶意DLL中的函数。

### 防范措施

1. **代码签名**：确保所有加载的DLL都是经过数字签名的可信文件。
2. **进程隔离**：将高敏感性操作放在独立的进程中运行，限制其与其他进程的交互。
3. **监控和检测**：使用防病毒软件和其他安全工具监控系统中异常的DLL加载行为。
4. **最小权限原则**：以最低权限运行应用程序，减少恶意代码利用高权限注入DLL的机会。

DLL注入是一种强大且广泛使用的技术，因此理解其工作原理和防范措施对于维护系统安全至关重要。