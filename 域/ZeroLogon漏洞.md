ZeroLogon（CVE-2020-1472）是一种严重的安全漏洞，影响微软的Netlogon远程协议（MS-NRPC）。Netlogon协议用于在域控制器与域成员（如工作站和服务器）之间进行身份验证。ZeroLogon漏洞允许攻击者通过操纵Netlogon协议，在没有有效凭据的情况下，冒充任意计算机甚至域控制器，获得域管理员权限。

### ZeroLogon 漏洞的关键点

1. **漏洞的本质**：
   - ZeroLogon漏洞利用了Netlogon协议中的一个设计缺陷，该缺陷在某些情况下允许攻击者使用全零的初始化向量（IV）来加密消息。由于Netlogon协议的实现方式，攻击者可以通过这种方式绕过身份验证机制。

2. **攻击条件**：
   - 攻击者需要能够访问受影响域控制器的Netlogon远程协议服务（通常在TCP端口135和445上提供）。

3. **漏洞利用**：
   - 攻击者可以通过发送特制的Netlogon身份验证请求，使用全零的IV绕过身份验证，并将自身身份冒充为域控制器。这使得攻击者能够更改域控制器的密码，进而完全控制整个域。

### ZeroLogon 的攻击步骤

1. **准备攻击**：
   - 攻击者必须能够与目标域控制器建立Netlogon会话。这通常要求攻击者在网络内部或通过其他手段已经取得对目标网络的一些访问权限。

2. **发送特制的Netlogon请求**：
   - 攻击者向目标域控制器发送特制的Netlogon身份验证请求，利用漏洞绕过身份验证。

3. **修改域控制器密码**：
   - 一旦身份验证成功，攻击者可以利用这一会话修改域控制器的机密（即密码），使得他们能够以域控制器的身份执行各种操作。

4. **获得域管理员权限**：
   - 攻击者修改域控制器密码后，可以通过其他工具（如Mimikatz）进一步提升权限，最终获得域管理员权限。

### ZeroLogon 的影响

ZeroLogon漏洞的影响极其严重，主要表现在：

1. **完全控制域**：
   - 攻击者可以获得域管理员权限，完全控制受影响域中的所有计算机和账户。

2. **横向移动和持久性**：
   - 攻击者可以在整个网络中横向移动，安装后门，持久控制网络。

3. **数据泄露和破坏**：
   - 攻击者可以访问和窃取敏感数据，或破坏关键系统，导致严重的业务中断。

### 防护措施

由于ZeroLogon漏洞的严重性，企业应立即采取以下措施进行防护：

1. **立即更新**：
   - 微软已发布针对ZeroLogon漏洞的安全补丁（2020年8月11日的安全更新）。企业应立即应用这些补丁，确保所有域控制器和相关系统都已更新。

2. **限制网络访问**：
   - 限制对Netlogon远程协议服务的网络访问，确保只有受信任的系统能够访问相关端口。

3. **监控和检测**：
   - 启用并配置安全信息和事件管理（SIEM）系统，监控Netlogon服务的异常活动，及时发现潜在攻击。

4. **审查和重置密码**：
   - 审查和重置可能受到影响的账户密码，尤其是域控制器和其他关键服务的密码。

5. **多因素认证**：
   - 实施多因素认证（MFA），增加额外的安全层，防止凭据被滥用。

### 总结

ZeroLogon是一个极其严重的安全漏洞，利用Netlogon协议中的设计缺陷，允许攻击者在没有有效凭据的情况下获得域管理员权限。企业应立即采取补救措施，包括应用安全补丁、限制网络访问、启用监控和检测机制，以及审查和重置密码，以防止潜在的攻击和损害。